(function(){"use strict";if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.plugins"),sigma.plugins.dragNodes=function(a,b){if(sigma.renderers.webgl&&b instanceof sigma.renderers.webgl)throw new Error("The sigma.plugins.dragNodes is not compatible with the WebGL renderer");var c=document.body,d=b.container,e=d.lastChild,f=b.camera,g=null,h="",i=[],j=!1;h=b instanceof sigma.renderers.webgl?b.options.prefix.substr(5):b.options.prefix;var k=function(a){i.push(a.data.node),i.length&&!j&&(g=i[i.length-1],e.addEventListener("mousedown",m))},l=function(a){var b=i.map(function(a){return a}).indexOf(a.data.node);i.splice(b,1),i.length&&!j?g=i[i.length-1]:e.removeEventListener("mousedown",m)},m=function(){j=!0;var d=a.graph.nodes().length;d>1&&(e.removeEventListener("mousedown",m),c.addEventListener("mousemove",o),c.addEventListener("mouseup",n),b.settings({mouseEnabled:!1,enableHovering:!1}),a.refresh())},n=function(){j=!1,e.addEventListener("mousedown",m),c.removeEventListener("mousemove",o),c.removeEventListener("mouseup",n),b.settings({mouseEnabled:!0,enableHovering:!0}),a.refresh()},o=function(b){function c(){for(var c=b.pageX-d.offsetLeft,e=b.pageY-d.offsetTop,i=Math.cos(f.angle),j=Math.sin(f.angle),k=a.graph.nodes(),l=[],m=0;2>m;m++){var n=k[m],o={x:n.x*i+n.y*j,y:n.y*i-n.x*j,renX:n[h+"x"],renY:n[h+"y"]};l.push(o)}c=(c-l[0].renX)/(l[1].renX-l[0].renX)*(l[1].x-l[0].x)+l[0].x,e=(e-l[0].renY)/(l[1].renY-l[0].renY)*(l[1].y-l[0].y)+l[0].y,g.x=c*i-e*j,g.y=e*i+c*j,a.refresh()}if(navigator.userAgent.toLowerCase().indexOf("firefox")>-1){clearTimeout(e);var e=setTimeout(c,0)}else c()};b.bind("overNode",k),b.bind("outNode",l)}}).call(window);